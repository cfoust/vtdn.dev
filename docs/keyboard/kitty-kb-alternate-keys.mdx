---
sidebar_position: 4
title: "Report alternate keys"
sidebar_label: "Report alternate keys"
description: "Kitty keyboard flag 4"
feature_id: "kitty_kb_alternate_keys"
data_file: "keyboard-input"
---

:::warning[AI-Generated Content]
This page was generated with the assistance of AI and may contain inaccuracies. It is intended as a starting point and should be verified against the linked specifications.
:::

<StatusBadges status={{ experimental: true }} />

**Report alternate keys** (flag 4) extends the Kitty keyboard protocol to include the shifted key value and the base layout key value in key event reports. This allows applications to understand both the physical key pressed and the character it would produce under the current keyboard layout and shift state.

## Syntax

```
CSI unicode : shifted : base ; modifiers u    Key event with alternate keys
```

<FormalSyntax grammar={`
key-event   = 0x1b, "[", key-code, [ ":", shifted-key ], [ ":", base-key ], [ ";", modifiers ], "u" ;
key-code    = digit, { digit } ;             (* Unicode codepoint of the key *)
shifted-key = digit, { digit } ;             (* codepoint when Shift is held *)
base-key    = digit, { digit } ;             (* codepoint on the base keyboard layout *)
modifiers   = digit, { digit } ;             (* modifier bitmask + 1 *)
digit       = "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9" ;
`} />

### Alternate key fields

| Field | Description |
|-------|-------------|
| `unicode` | The effective key codepoint for the current keyboard layout and modifier state |
| `shifted` | The codepoint that would be produced if Shift were held (omitted if same as `unicode` or not applicable) |
| `base` | The codepoint of the key on the base (e.g., US English) keyboard layout (omitted if same as `unicode`) |

## Description

On most keyboard layouts, a physical key can produce different characters depending on modifiers and the active layout. For example, on a US layout, the physical `2` key produces `2` normally and `@` with Shift. On a German layout, the same physical position produces a different character entirely.

Without this flag, applications only receive the final resolved character and cannot determine which physical key was pressed or what the shifted variant would be. This is problematic for applications like games or keyboard shortcut systems that want to bind actions to physical key positions regardless of the active keyboard layout.

When flag 4 is enabled, the terminal includes up to two additional codepoints in the key event, separated by colons after the primary key code:

- **Shifted key**: The codepoint that the key produces when Shift is held. This is only included when it differs from the primary key code and is meaningful.
- **Base layout key**: The codepoint the key would produce on the base keyboard layout (typically US English). This is only included when it differs from the primary key code.

If a field is not applicable or is the same as the primary key code, it is left empty (but the colon separator is still present if a subsequent field is needed).

### Use cases

- **Games**: Bind movement to WASD physical key positions regardless of keyboard layout (e.g., AZERTY users get the same physical layout)
- **Keyboard shortcuts**: An application can define Ctrl+Z as "Ctrl + the key at the Z position" on any layout
- **International input**: Applications can present shortcuts labeled with the user's actual layout characters while binding to physical positions

## Examples

```bash
# Enable disambiguate + alternate keys (flags 1|4 = 5)
printf '\e[>5u'

# On a US layout, pressing Shift+2 (which produces '@'):
#   ESC [ 6 4 : : 5 0 ; 2 u
#   64 = '@' (effective), shifted omitted, 50 = '2' (base), modifier 2 = Shift

# On a German layout, pressing the key at the 'z' position
# (which produces 'y' on German QWERTZ):
#   ESC [ 1 2 1 : : 1 2 2 u
#   121 = 'y' (effective on German), base 122 = 'z' (US layout)

# When shifted and base are the same as the primary key,
# only the primary key is sent:
#   ESC [ 9 7 u
#   97 = 'a' (no alternate information needed)

# Restore previous mode
printf '\e[<u'
```

## Specifications

<SpecificationsTable />

## Terminal support

<FeatureCompatTable />

## See also

- [Kitty Keyboard Protocol](/docs/keyboard/kitty-keyboard) -- Overview of the full protocol
- [Disambiguate](/docs/keyboard/kitty-kb-disambiguate) -- Flag 1: unambiguous key encoding
- [Report Associated Text](/docs/keyboard/kitty-kb-associated-text) -- Flag 16: include generated text in events
