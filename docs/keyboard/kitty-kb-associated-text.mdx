---
sidebar_position: 6
title: "Report associated text"
sidebar_label: "Report associated text"
description: "Kitty keyboard flag 16"
feature_id: "kitty_kb_associated_text"
data_file: "keyboard-input"
---

:::warning[AI-Generated Content]
This page was generated with the assistance of AI and may contain inaccuracies. It is intended as a starting point and should be verified against the linked specifications.
:::

<StatusBadges status={{ experimental: true }} />

**Report associated text** (flag 16) extends the Kitty keyboard protocol to include the text that would have been generated by a key event in the escape sequence itself. The text is encoded as a colon-separated list of Unicode codepoints appended as a third parameter to the key event.

## Syntax

```
CSI number ; modifiers ; text u    Key event with associated text
```

<FormalSyntax grammar={`
key-event   = 0x1b, "[", key-code, [ ";", modifiers ], [ ";", text ], "u" ;
key-code    = digit, { digit } ;             (* Unicode codepoint of the key *)
modifiers   = digit, { digit } ;             (* modifier bitmask + 1 *)
text        = codepoint, { ":", codepoint } ; (* colon-separated Unicode codepoints *)
codepoint   = digit, { digit } ;
digit       = "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9" ;
`} />

## Description

When other Kitty keyboard protocol flags are active, the key event reports the physical key that was pressed (as a Unicode codepoint), but not necessarily the text that the key press would generate. In most cases these are the same, but they can differ:

- **Dead keys and compose sequences**: Pressing a dead key (like `'` on an international layout) followed by `e` produces the character. The key events report the individual key presses, but the associated text reports the composed result.
- **Input method editors (IMEs)**: An IME may consume multiple key presses and produce a single composed character or string.
- **Shift and layout transformations**: Pressing Shift+2 on a US layout produces `@`. The key code reports `2` (the physical key), but the associated text reports `@` (the generated character).

When flag 16 is enabled, the text that would be produced by the key event is included as the third semicolon-separated parameter. The text is encoded as a colon-separated list of Unicode codepoints (in decimal). If the key press does not generate any text (e.g., pressing a modifier key alone, or a function key), the text field is omitted.

### When text differs from the key code

The associated text is most useful when it differs from the key code:

| Scenario | Key code | Associated text |
|----------|----------|----------------|
| Shift+2 on US layout | `50` (digit 2) | `64` (@ symbol) |
| Compose sequence result | Last key in sequence | Composed character |
| IME output | Last key pressed | Full composed string |
| Function key (F1) | `57344` | (omitted, no text generated) |

### Interaction with other flags

Flag 16 is typically combined with flags 1 and 8 to get associated text for all key events. Without flag 8, only keys that already produce CSI sequences will carry associated text. The combination of all flags (`CSI > 31 u`) provides the most complete keyboard reporting available.

The associated text field occupies the third parameter position. If event types (flag 2) are active, the modifier parameter carries both the modifier bitmask and the event type (`modifiers:event_type`), followed by the text field:

```
CSI key_code ; modifiers:event_type ; text u
```

## Examples

```bash
# Enable all enhancements (flags 1|2|4|8|16 = 31)
printf '\e[>31u'

# Pressing 'a' produces:
#   ESC [ 9 7 ; 1 ; 9 7 u
#   key=97 ('a'), modifiers=1 (none), text=97 ('a')

# Pressing Shift+2 on US layout (produces '@'):
#   ESC [ 5 0 ; 2 ; 6 4 u
#   key=50 ('2'), modifiers=2 (Shift), text=64 ('@')

# Pressing a dead key sequence (e.g., compose ' then e = e-acute):
#   First key (dead accent): ESC [ 39 ; 1 u
#   (no associated text -- dead key does not generate text alone)
#   Second key (e): ESC [ 1 0 1 ; 1 ; 2 3 3 u
#   key=101 ('e'), text=233 (U+00E9 'e-acute')

# Pressing F1 (no text generated):
#   ESC [ 5 7 3 4 4 u
#   (text field omitted entirely)

# Pressing a key that generates multiple codepoints:
#   ESC [ 101 ; 1 ; 101:769 u
#   text is colon-separated list: 101 (e) and 769 (combining acute)

# Restore previous mode
printf '\e[<u'
```

## Specifications

<SpecificationsTable />

## Terminal support

<FeatureCompatTable />

## See also

- [Kitty Keyboard Protocol](/docs/keyboard/kitty-keyboard) -- Overview of the full protocol
- [Report Alternate Keys](/docs/keyboard/kitty-kb-alternate-keys) -- Flag 4: physical key layout information
- [All Keys as Escape Codes](/docs/keyboard/kitty-kb-all-keys) -- Flag 8: ensure all keys report as CSI u sequences
